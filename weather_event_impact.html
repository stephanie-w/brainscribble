<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>R: Analysis of weather events impact on population health and economy. - Brain Scribble</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <link href="http://stephanie-w.github.io/brainscribble/images/brain-scribble-ico.png" rel="icon">

<link rel="canonical" href="http://stephanie-w.github.io/brainscribble/weather_event_impact.html">

        <meta name="author" content="Stephanie W" />
        <meta name="keywords" content="R" />
        <meta name="description" content="Synopsis This analysis involves exploring the U.S. National Oceanic and Atmospheric Administration&#39;s (NOAA) storm database. This database tracks characteristics of major storms and weather events in the United States, including when and where they occur, as well as estimates of any fatalities, injuries, and property damage. This analysis ..." />

        <meta property="og:site_name" content="Brain Scribble" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="R: Analysis of weather events impact on population health and economy."/>
        <meta property="og:url" content="http://stephanie-w.github.io/brainscribble/weather_event_impact.html"/>
        <meta property="og:description" content="Synopsis This analysis involves exploring the U.S. National Oceanic and Atmospheric Administration&#39;s (NOAA) storm database. This database tracks characteristics of major storms and weather events in the United States, including when and where they occur, as well as estimates of any fatalities, injuries, and property damage. This analysis ..."/>
        <meta property="article:published_time" content="2015-06-15" />
            <meta property="article:section" content="DataAnalysis" />
            <meta property="article:tag" content="R" />
            <meta property="article:author" content="Stephanie W" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://stephanie-w.github.io/brainscribble/theme/css/bootstrap.lumen.min.css" type="text/css"/>
    <link href="http://stephanie-w.github.io/brainscribble/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://stephanie-w.github.io/brainscribble/theme/css/pygments/solarized.css" rel="stylesheet">
    <link rel="stylesheet" href="http://stephanie-w.github.io/brainscribble/theme/css/style.css" type="text/css"/>

        <link href="http://stephanie-w.github.io/brainscribble/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Brain Scribble ATOM Feed"/>



        <link href="http://stephanie-w.github.io/brainscribble/feeds/dataanalysis.atom.xml" type="application/atom+xml" rel="alternate"
              title="Brain Scribble DataAnalysis ATOM Feed"/>

    <!-- Mathjax -->
    <script type="text/javascript"
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://stephanie-w.github.io/brainscribble/" class="navbar-brand">
            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li class="active">
                            <a href="http://stephanie-w.github.io/brainscribble/category/dataanalysis.html">DataAnalysis</a>
                        </li>
                        <li >
                            <a href="http://stephanie-w.github.io/brainscribble/category/games.html">Games</a>
                        </li>
                        <li >
                            <a href="http://stephanie-w.github.io/brainscribble/category/projectmanagement.html">ProjectManagement</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="http://stephanie-w.github.io/brainscribble/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://stephanie-w.github.io/brainscribble/weather_event_impact.html"
                       rel="bookmark"
                       title="Permalink to R: Analysis of weather events impact on population health and economy.">
                        R: Analysis of weather events impact on population health and economy.
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-06-15T00:00:00+02:00"> 2015-06-15</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="http://stephanie-w.github.io/brainscribble/tag/r.html">R</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <hr />
<h2 id="synopsis">Synopsis</h2>
<!-- BEGIN_SUMMARY -->

<p>This analysis involves exploring the U.S. National Oceanic and Atmospheric Administration's (NOAA) storm database. </p>
<!-- END_SUMMARY -->

<p>This database tracks characteristics of major storms and weather events in the United States, including when and where they occur, as well as estimates of any fatalities, injuries, and property damage.</p>
<p>This analysis focuses on fatalities, injuries, property and crop damages to answer to the 2 following questions : 
Across the United States, which types of events (as indicated in the EVTYPE variable) are most harmful with respect to population health?
Across the United States, which types of events have the greatest economic consequences?</p>
<h2 id="data-processing">Data Processing</h2>
<p>The data comes in the form of a comma-separated-value file compressed via the bzip2.</p>
<p>We download it and unzip it in a ProjectData directory:</p>
<div class="highlight"><pre><span class="code-line">download.file<span class="p">(</span><span class="s">&quot;https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2&quot;</span><span class="p">,</span> <span class="s">&quot;FStormData.csv.bz2&quot;</span><span class="p">,</span> </span>
<span class="code-line">    method <span class="o">=</span> <span class="s">&quot;curl&quot;</span><span class="p">,</span> quiet <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line">raw <span class="o">&lt;-</span> read.csv<span class="p">(</span><span class="kp">bzfile</span><span class="p">(</span><span class="s">&quot;FStormData.csv.bz2&quot;</span><span class="p">),</span> sep <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="p">,</span> quote <span class="o">=</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">,</span> header <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> stringsAsFactors <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span></span>
<span class="code-line"><span class="kp">raw</span><span class="o">$</span>BGN_DATE <span class="o">&lt;-</span> <span class="kp">as.Date</span><span class="p">(</span><span class="kp">raw</span><span class="o">$</span>BGN_DATE<span class="p">,</span> format <span class="o">=</span> <span class="s">&quot;%m/%d/%Y %H:%M:%S&quot;</span><span class="p">)</span></span>
<span class="code-line"><span class="kp">raw</span><span class="o">$</span>END_DATE <span class="o">&lt;-</span> <span class="kp">as.Date</span><span class="p">(</span><span class="kp">raw</span><span class="o">$</span>END_DATE<span class="p">,</span> format <span class="o">=</span> <span class="s">&quot;%m/%d/%Y %H:%M:%S&quot;</span><span class="p">)</span></span>
</pre></div>


<p>The Storm Events Database reports that all weather events are only recorded since 1996 (see http://www.ncdc.noaa.gov/stormevents/details.jsp).</p>
<div class="highlight"><pre><span class="code-line">    Event Types Available:</span>
<span class="code-line">    Add more info about event types here. Link to collections page/tab when referencing data collection source.</span>
<span class="code-line"></span>
<span class="code-line">    1. Tornado: From 1950 through 1954, only tornado events were recorded.</span>
<span class="code-line"></span>
<span class="code-line">    2. Tornado, Thunderstorm Wind and Hail: From 1955 through 1992, only tornado, thunderstorm wind and hail events were keyed from the paper publications into digital data. From 1993 to 1995, only tornado, thunderstorm wind and hail events have been extracted from the Unformatted Text Files.</span>
<span class="code-line"></span>
<span class="code-line">    3. All Event Types (48 from Directive 10-1605): From 1996 to present, 48 event types are recorded as defined in NWS Directive 10-1605.</span>
</pre></div>


<p>Since we're reporting impacts from various weather events, we'll focus our study on data since 1996.</p>
<div class="highlight"><pre><span class="code-line">data <span class="o">&lt;-</span> <span class="kp">raw</span><span class="p">[</span><span class="kp">raw</span><span class="o">$</span>BGN_DATE <span class="o">&gt;</span> <span class="s">&quot;1996-01-01&quot;</span><span class="p">,</span> <span class="p">]</span></span>
<span class="code-line"><span class="kp">rm</span><span class="p">(</span><span class="kp">raw</span><span class="p">)</span></span>
</pre></div>


<h2 id="results">Results</h2>
<p><em>Weather events impact on population health across the United States since 1996</em></p>
<p>To study the weather events impact on poulation health, we examine the INJURIES AND FATALITIES columns of the dataset.</p>
<p>We compute the sum of total of injuries/fatalities by weather event type an store the values in a new dataset:</p>
<div class="highlight"><pre><span class="code-line">fat_by_ev <span class="o">&lt;-</span> aggregate<span class="p">(</span>FATALITIES <span class="o">~</span> EVTYPE<span class="p">,</span> data <span class="o">=</span> data<span class="p">,</span> <span class="kp">sum</span><span class="p">,</span> na.rm <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span></span>
<span class="code-line">inj_by_ev <span class="o">&lt;-</span> aggregate<span class="p">(</span>INJURIES <span class="o">~</span> EVTYPE<span class="p">,</span> data <span class="o">=</span> data<span class="p">,</span> <span class="kp">sum</span><span class="p">,</span> na.rm <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span></span>
</pre></div>


<p>For fatalities, the quantile function shows that only 1% of the values of the total of injuries/fatalities by event type are significant (&gt; 326 fatalities, &gt; 1635 injuries).</p>
<div class="highlight"><pre><span class="code-line">quantile<span class="p">(</span>fat_by_ev<span class="o">$</span>FATALITIES<span class="p">,</span> probs <span class="o">=</span> <span class="kp">seq</span><span class="p">(</span><span class="m">0.9</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.01</span><span class="p">))</span></span>
</pre></div>


<div class="highlight"><pre><span class="code-line">##     90%     91%     92%     93%     94%     95%     96%     97%     98%     99%    100% </span>
<span class="code-line">##    4.00    5.74    9.88   14.02   28.80   57.90   78.08  105.32  198.92  326.14 1797.00</span>
</pre></div>


<div class="highlight"><pre><span class="code-line">quantile<span class="p">(</span>inj_by_ev<span class="o">$</span>INJURIES<span class="p">,</span> probs <span class="o">=</span> <span class="kp">seq</span><span class="p">(</span><span class="m">0.9</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.01</span><span class="p">))</span></span>
</pre></div>


<div class="highlight"><pre><span class="code-line">##      90%      91%      92%      93%      94%      95%      96%      97%      98%      99%     100% </span>
<span class="code-line">##    21.60    25.74    39.76    70.04    85.76   171.90   304.56   477.80  1034.84  1635.64 20667.00</span>
</pre></div>


<p>We order the new datas by fatalities/injuries (decreasing order) and display the 10th first rows:</p>
<div class="highlight"><pre><span class="code-line">fat_temp <span class="o">&lt;-</span> fat_by_ev<span class="p">[</span><span class="kp">order</span><span class="p">(</span>fat_by_ev<span class="o">$</span>FATALITIES<span class="p">,</span> decreasing <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span> <span class="p">][</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span> <span class="p">]</span></span>
<span class="code-line"><span class="kp">colnames</span><span class="p">(</span>fat_temp<span class="p">)</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;event.type&quot;</span><span class="p">,</span> <span class="s">&quot;fatalities&quot;</span><span class="p">)</span></span>
<span class="code-line">inj_temp <span class="o">&lt;-</span> inj_by_ev<span class="p">[</span><span class="kp">order</span><span class="p">(</span>inj_by_ev<span class="o">$</span>INJURIES<span class="p">,</span> decreasing <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span> <span class="p">][</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span> <span class="p">]</span></span>
<span class="code-line"><span class="kp">colnames</span><span class="p">(</span>inj_temp<span class="p">)</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;event.type&quot;</span><span class="p">,</span> <span class="s">&quot;injuries&quot;</span><span class="p">)</span></span>
<span class="code-line"><span class="kn">library</span><span class="p">(</span>knitr<span class="p">)</span></span>
<span class="code-line">kable<span class="p">(</span>fat_temp<span class="p">,</span> caption <span class="o">=</span> <span class="s">&quot;Total fatalities by weather event type since 1996&quot;</span><span class="p">)</span></span>
</pre></div>


<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">event.type</th>
<th align="right">fatalities</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">75</td>
<td align="left">EXCESSIVE HEAT</td>
<td align="right">1797</td>
</tr>
<tr>
<td align="left">417</td>
<td align="left">TORNADO</td>
<td align="right">1511</td>
</tr>
<tr>
<td align="left">96</td>
<td align="left">FLASH FLOOD</td>
<td align="right">887</td>
</tr>
<tr>
<td align="left">213</td>
<td align="left">LIGHTNING</td>
<td align="right">650</td>
</tr>
<tr>
<td align="left">99</td>
<td align="left">FLOOD</td>
<td align="right">414</td>
</tr>
<tr>
<td align="left">286</td>
<td align="left">RIP CURRENT</td>
<td align="right">340</td>
</tr>
<tr>
<td align="left">423</td>
<td align="left">TSTM WIND</td>
<td align="right">241</td>
</tr>
<tr>
<td align="left">143</td>
<td align="left">HEAT</td>
<td align="right">237</td>
</tr>
<tr>
<td align="left">161</td>
<td align="left">HIGH WIND</td>
<td align="right">235</td>
</tr>
<tr>
<td align="left">16</td>
<td align="left">AVALANCHE</td>
<td align="right">223</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span class="code-line">kable<span class="p">(</span>inj_temp<span class="p">,</span> caption <span class="o">=</span> <span class="s">&quot;Total injuries by weather event type since 1996&quot;</span><span class="p">)</span></span>
</pre></div>


<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">event.type</th>
<th align="right">injuries</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">417</td>
<td align="left">TORNADO</td>
<td align="right">20667</td>
</tr>
<tr>
<td align="left">99</td>
<td align="left">FLOOD</td>
<td align="right">6758</td>
</tr>
<tr>
<td align="left">75</td>
<td align="left">EXCESSIVE HEAT</td>
<td align="right">6391</td>
</tr>
<tr>
<td align="left">213</td>
<td align="left">LIGHTNING</td>
<td align="right">4140</td>
</tr>
<tr>
<td align="left">423</td>
<td align="left">TSTM WIND</td>
<td align="right">3629</td>
</tr>
<tr>
<td align="left">96</td>
<td align="left">FLASH FLOOD</td>
<td align="right">1674</td>
</tr>
<tr>
<td align="left">413</td>
<td align="left">THUNDERSTORM WIND</td>
<td align="right">1400</td>
</tr>
<tr>
<td align="left">496</td>
<td align="left">WINTER STORM</td>
<td align="right">1292</td>
</tr>
<tr>
<td align="left">167</td>
<td align="left">HURRICANE/TYPHOON</td>
<td align="right">1275</td>
</tr>
<tr>
<td align="left">143</td>
<td align="left">HEAT</td>
<td align="right">1222</td>
</tr>
</tbody>
</table>
<p>Then plot the datas:</p>
<div class="highlight"><pre><span class="code-line"><span class="kn">library</span><span class="p">(</span>ggplot2<span class="p">)</span></span>
<span class="code-line">ggplot<span class="p">(</span>fat_temp<span class="p">,</span> aes<span class="p">(</span>reorder<span class="p">(</span><span class="kp">factor</span><span class="p">(</span>event.type<span class="p">),</span> <span class="o">-</span>fatalities<span class="p">),</span> fatalities<span class="p">))</span> <span class="o">+</span> geom_bar<span class="p">(</span>stat <span class="o">=</span> <span class="s">&quot;identity&quot;</span><span class="p">)</span> <span class="o">+</span> </span>
<span class="code-line">    labs<span class="p">(</span>x <span class="o">=</span> <span class="s">&quot;Weather event type&quot;</span><span class="p">,</span> y <span class="o">=</span> <span class="s">&quot;Fatalities&quot;</span><span class="p">,</span> title <span class="o">=</span> <span class="s">&quot;Total fatalities by weather event type since 1996&quot;</span><span class="p">)</span> <span class="o">+</span> </span>
<span class="code-line">    theme<span class="p">(</span>axis.text.x <span class="o">=</span> element_text<span class="p">(</span>angle <span class="o">=</span> <span class="m">90</span><span class="p">,</span> hjust <span class="o">=</span> <span class="m">1</span><span class="p">))</span></span>
</pre></div>


<div class="rimage center"><img src="figure/weather_events_impact_fatalities-1.png" title="plot of chunk weather_events_impact_fatalities" alt="plot of chunk weather_events_impact_fatalities" class="plot" /></div>

<div class="highlight"><pre><span class="code-line">ggplot<span class="p">(</span>inj_temp<span class="p">,</span> aes<span class="p">(</span>reorder<span class="p">(</span><span class="kp">factor</span><span class="p">(</span>event.type<span class="p">),</span> <span class="o">-</span>injuries<span class="p">),</span> injuries<span class="p">))</span> <span class="o">+</span> geom_bar<span class="p">(</span>stat <span class="o">=</span> <span class="s">&quot;identity&quot;</span><span class="p">)</span> <span class="o">+</span> </span>
<span class="code-line">    labs<span class="p">(</span>x <span class="o">=</span> <span class="s">&quot;Weather event type&quot;</span><span class="p">,</span> y <span class="o">=</span> <span class="s">&quot;Injuries&quot;</span><span class="p">,</span> title <span class="o">=</span> <span class="s">&quot;Total injuries by weather event type since 1996&quot;</span><span class="p">)</span> <span class="o">+</span> </span>
<span class="code-line">    theme<span class="p">(</span>axis.text.x <span class="o">=</span> element_text<span class="p">(</span>angle <span class="o">=</span> <span class="m">90</span><span class="p">,</span> hjust <span class="o">=</span> <span class="m">1</span><span class="p">))</span></span>
</pre></div>


<div class="rimage center"><img src="figure/weather_events_impact_injuries-1.png" title="plot of chunk weather_events_impact_injuries" alt="plot of chunk weather_events_impact_injuries" class="plot" /></div>

<p>To go deeper, we can examine single weather types by having a closer look on their frequency/injuries and fatalities ratio :</p>
<div class="highlight"><pre><span class="code-line"><span class="kn">library</span><span class="p">(</span>plyr<span class="p">)</span></span>
<span class="code-line">fat_ev_count <span class="o">&lt;-</span> count<span class="p">(</span>data<span class="p">[</span>data<span class="o">$</span>FATALITIES <span class="o">&gt;</span> <span class="m">0</span><span class="p">,</span> <span class="p">],</span> vars <span class="o">=</span> <span class="s">&quot;EVTYPE&quot;</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line">temp <span class="o">&lt;-</span> <span class="kp">merge</span><span class="p">(</span>fat_ev_count<span class="p">,</span> fat_by_ev<span class="p">,</span> by <span class="o">=</span> <span class="s">&quot;EVTYPE&quot;</span><span class="p">)</span></span>
<span class="code-line">temp<span class="o">$</span>ratio <span class="o">&lt;-</span> temp<span class="o">$</span>FATALITIES<span class="o">/</span>temp<span class="o">$</span>freq</span>
<span class="code-line"><span class="kp">colnames</span><span class="p">(</span>temp<span class="p">)</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;event.type&quot;</span><span class="p">,</span> <span class="s">&quot;event.frequency&quot;</span><span class="p">,</span> <span class="s">&quot;event.fatalities&quot;</span><span class="p">,</span> <span class="s">&quot;event.fatalities.ratio&quot;</span><span class="p">)</span></span>
<span class="code-line">kable<span class="p">(</span>temp<span class="p">[</span><span class="kp">order</span><span class="p">(</span>temp<span class="o">$</span>event.frequency<span class="p">,</span> decreasing <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span> <span class="p">][</span><span class="m">1</span><span class="o">:</span><span class="m">30</span><span class="p">,</span> <span class="p">],</span> caption <span class="o">=</span> <span class="s">&quot;Total fatalities by weather event type (ordered by frequency desc) since 1996&quot;</span><span class="p">)</span></span>
</pre></div>


<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">event.type</th>
<th align="right">event.frequency</th>
<th align="right">event.fatalities</th>
<th align="right">event.fatalities.ratio</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">63</td>
<td align="left">LIGHTNING</td>
<td align="right">608</td>
<td align="right">650</td>
<td align="right">1.069079</td>
</tr>
<tr>
<td align="left">27</td>
<td align="left">FLASH FLOOD</td>
<td align="right">584</td>
<td align="right">887</td>
<td align="right">1.518836</td>
</tr>
<tr>
<td align="left">20</td>
<td align="left">EXCESSIVE HEAT</td>
<td align="right">564</td>
<td align="right">1797</td>
<td align="right">3.186170</td>
</tr>
<tr>
<td align="left">92</td>
<td align="left">TORNADO</td>
<td align="right">459</td>
<td align="right">1511</td>
<td align="right">3.291939</td>
</tr>
<tr>
<td align="left">74</td>
<td align="left">RIP CURRENT</td>
<td align="right">301</td>
<td align="right">340</td>
<td align="right">1.129568</td>
</tr>
<tr>
<td align="left">28</td>
<td align="left">FLOOD</td>
<td align="right">270</td>
<td align="right">414</td>
<td align="right">1.533333</td>
</tr>
<tr>
<td align="left">94</td>
<td align="left">TSTM WIND</td>
<td align="right">212</td>
<td align="right">241</td>
<td align="right">1.136793</td>
</tr>
<tr>
<td align="left">75</td>
<td align="left">RIP CURRENTS</td>
<td align="right">179</td>
<td align="right">202</td>
<td align="right">1.128492</td>
</tr>
<tr>
<td align="left">48</td>
<td align="left">HIGH WIND</td>
<td align="right">176</td>
<td align="right">235</td>
<td align="right">1.335227</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">AVALANCHE</td>
<td align="right">173</td>
<td align="right">223</td>
<td align="right">1.289017</td>
</tr>
<tr>
<td align="left">38</td>
<td align="left">HEAT</td>
<td align="right">133</td>
<td align="right">237</td>
<td align="right">1.781955</td>
</tr>
<tr>
<td align="left">104</td>
<td align="left">WINTER STORM</td>
<td align="right">118</td>
<td align="right">191</td>
<td align="right">1.618644</td>
</tr>
<tr>
<td align="left">90</td>
<td align="left">THUNDERSTORM WIND</td>
<td align="right">107</td>
<td align="right">130</td>
<td align="right">1.214953</td>
</tr>
<tr>
<td align="left">85</td>
<td align="left">STRONG WIND</td>
<td align="right">90</td>
<td align="right">103</td>
<td align="right">1.144444</td>
</tr>
<tr>
<td align="left">22</td>
<td align="left">EXTREME COLD/WIND CHILL</td>
<td align="right">87</td>
<td align="right">125</td>
<td align="right">1.436782</td>
</tr>
<tr>
<td align="left">21</td>
<td align="left">EXTREME COLD</td>
<td align="right">86</td>
<td align="right">113</td>
<td align="right">1.313953</td>
</tr>
<tr>
<td align="left">41</td>
<td align="left">HEAVY SNOW</td>
<td align="right">75</td>
<td align="right">107</td>
<td align="right">1.426667</td>
</tr>
<tr>
<td align="left">11</td>
<td align="left">COLD/WIND CHILL</td>
<td align="right">74</td>
<td align="right">95</td>
<td align="right">1.283784</td>
</tr>
<tr>
<td align="left">45</td>
<td align="left">HIGH SURF</td>
<td align="right">63</td>
<td align="right">87</td>
<td align="right">1.380952</td>
</tr>
<tr>
<td align="left">39</td>
<td align="left">HEAVY RAIN</td>
<td align="right">59</td>
<td align="right">94</td>
<td align="right">1.593220</td>
</tr>
<tr>
<td align="left">58</td>
<td align="left">ICE STORM</td>
<td align="right">51</td>
<td align="right">82</td>
<td align="right">1.607843</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">BLIZZARD</td>
<td align="right">46</td>
<td align="right">70</td>
<td align="right">1.521739</td>
</tr>
<tr>
<td align="left">29</td>
<td align="left">FOG</td>
<td align="right">35</td>
<td align="right">60</td>
<td align="right">1.714286</td>
</tr>
<tr>
<td align="left">105</td>
<td align="left">WINTER WEATHER</td>
<td align="right">29</td>
<td align="right">33</td>
<td align="right">1.137931</td>
</tr>
<tr>
<td align="left">101</td>
<td align="left">WILDFIRE</td>
<td align="right">28</td>
<td align="right">75</td>
<td align="right">2.678571</td>
</tr>
<tr>
<td align="left">43</td>
<td align="left">HEAVY SURF/HIGH SURF</td>
<td align="right">27</td>
<td align="right">42</td>
<td align="right">1.555556</td>
</tr>
<tr>
<td align="left">93</td>
<td align="left">TROPICAL STORM</td>
<td align="right">24</td>
<td align="right">57</td>
<td align="right">2.375000</td>
</tr>
<tr>
<td align="left">49</td>
<td align="left">HURRICANE</td>
<td align="right">23</td>
<td align="right">61</td>
<td align="right">2.652174</td>
</tr>
<tr>
<td align="left">98</td>
<td align="left">URBAN/SML STREAM FLD</td>
<td align="right">22</td>
<td align="right">28</td>
<td align="right">1.272727</td>
</tr>
<tr>
<td align="left">50</td>
<td align="left">HURRICANE/TYPHOON</td>
<td align="right">19</td>
<td align="right">64</td>
<td align="right">3.368421</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span class="code-line">inj_ev_count <span class="o">&lt;-</span> count<span class="p">(</span>data<span class="p">[</span>data<span class="o">$</span>INJURIES <span class="o">&gt;</span> <span class="m">0</span><span class="p">,</span> <span class="p">],</span> vars <span class="o">=</span> <span class="s">&quot;EVTYPE&quot;</span><span class="p">)</span></span>
<span class="code-line">temp <span class="o">&lt;-</span> <span class="kp">merge</span><span class="p">(</span>inj_ev_count<span class="p">,</span> inj_by_ev<span class="p">,</span> by <span class="o">=</span> <span class="s">&quot;EVTYPE&quot;</span><span class="p">)</span></span>
<span class="code-line">temp<span class="o">$</span>ratio <span class="o">&lt;-</span> temp<span class="o">$</span>INJURIES<span class="o">/</span>temp<span class="o">$</span>freq</span>
<span class="code-line"><span class="kp">colnames</span><span class="p">(</span>temp<span class="p">)</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;event.type&quot;</span><span class="p">,</span> <span class="s">&quot;event.frequency&quot;</span><span class="p">,</span> <span class="s">&quot;event.injuries&quot;</span><span class="p">,</span> <span class="s">&quot;event.injuries.ratio&quot;</span><span class="p">)</span></span>
<span class="code-line">kable<span class="p">(</span>temp<span class="p">[</span><span class="kp">order</span><span class="p">(</span>temp<span class="o">$</span>event.frequency<span class="p">,</span> decreasing <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span> <span class="p">][</span><span class="m">1</span><span class="o">:</span><span class="m">30</span><span class="p">,</span> <span class="p">],</span> caption <span class="o">=</span> <span class="s">&quot;Total Injuries by weather event type (ordered by frequency desc) since 1996&quot;</span><span class="p">)</span></span>
</pre></div>


<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">event.type</th>
<th align="right">event.frequency</th>
<th align="right">event.injuries</th>
<th align="right">event.injuries.ratio</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">56</td>
<td align="left">LIGHTNING</td>
<td align="right">2250</td>
<td align="right">4140</td>
<td align="right">1.840000</td>
</tr>
<tr>
<td align="left">85</td>
<td align="left">TORNADO</td>
<td align="right">1877</td>
<td align="right">20667</td>
<td align="right">11.010655</td>
</tr>
<tr>
<td align="left">87</td>
<td align="left">TSTM WIND</td>
<td align="right">1492</td>
<td align="right">3629</td>
<td align="right">2.432306</td>
</tr>
<tr>
<td align="left">83</td>
<td align="left">THUNDERSTORM WIND</td>
<td align="right">587</td>
<td align="right">1400</td>
<td align="right">2.385009</td>
</tr>
<tr>
<td align="left">43</td>
<td align="left">HIGH WIND</td>
<td align="right">403</td>
<td align="right">1083</td>
<td align="right">2.687345</td>
</tr>
<tr>
<td align="left">23</td>
<td align="left">FLASH FLOOD</td>
<td align="right">335</td>
<td align="right">1674</td>
<td align="right">4.997015</td>
</tr>
<tr>
<td align="left">99</td>
<td align="left">WILDFIRE</td>
<td align="right">184</td>
<td align="right">911</td>
<td align="right">4.951087</td>
</tr>
<tr>
<td align="left">34</td>
<td align="left">HAIL</td>
<td align="right">165</td>
<td align="right">713</td>
<td align="right">4.321212</td>
</tr>
<tr>
<td align="left">17</td>
<td align="left">EXCESSIVE HEAT</td>
<td align="right">162</td>
<td align="right">6391</td>
<td align="right">39.450617</td>
</tr>
<tr>
<td align="left">79</td>
<td align="left">STRONG WIND</td>
<td align="right">147</td>
<td align="right">278</td>
<td align="right">1.891156</td>
</tr>
<tr>
<td align="left">101</td>
<td align="left">WINTER STORM</td>
<td align="right">144</td>
<td align="right">1292</td>
<td align="right">8.972222</td>
</tr>
<tr>
<td align="left">24</td>
<td align="left">FLOOD</td>
<td align="right">142</td>
<td align="right">6758</td>
<td align="right">47.591549</td>
</tr>
<tr>
<td align="left">98</td>
<td align="left">WILD/FOREST FIRE</td>
<td align="right">130</td>
<td align="right">545</td>
<td align="right">4.192308</td>
</tr>
<tr>
<td align="left">68</td>
<td align="left">RIP CURRENT</td>
<td align="right">107</td>
<td align="right">209</td>
<td align="right">1.953271</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">AVALANCHE</td>
<td align="right">105</td>
<td align="right">156</td>
<td align="right">1.485714</td>
</tr>
<tr>
<td align="left">38</td>
<td align="left">HEAVY SNOW</td>
<td align="right">102</td>
<td align="right">698</td>
<td align="right">6.843137</td>
</tr>
<tr>
<td align="left">69</td>
<td align="left">RIP CURRENTS</td>
<td align="right">84</td>
<td align="right">294</td>
<td align="right">3.500000</td>
</tr>
<tr>
<td align="left">25</td>
<td align="left">FOG</td>
<td align="right">73</td>
<td align="right">712</td>
<td align="right">9.753425</td>
</tr>
<tr>
<td align="left">37</td>
<td align="left">HEAVY RAIN</td>
<td align="right">73</td>
<td align="right">230</td>
<td align="right">3.150685</td>
</tr>
<tr>
<td align="left">51</td>
<td align="left">ICE STORM</td>
<td align="right">53</td>
<td align="right">318</td>
<td align="right">6.000000</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">BLIZZARD</td>
<td align="right">41</td>
<td align="right">385</td>
<td align="right">9.390244</td>
</tr>
<tr>
<td align="left">15</td>
<td align="left">DUST STORM</td>
<td align="right">38</td>
<td align="right">376</td>
<td align="right">9.894737</td>
</tr>
<tr>
<td align="left">36</td>
<td align="left">HEAT</td>
<td align="right">36</td>
<td align="right">1222</td>
<td align="right">33.944444</td>
</tr>
<tr>
<td align="left">42</td>
<td align="left">HIGH SURF</td>
<td align="right">33</td>
<td align="right">146</td>
<td align="right">4.424242</td>
</tr>
<tr>
<td align="left">102</td>
<td align="left">WINTER WEATHER</td>
<td align="right">30</td>
<td align="right">343</td>
<td align="right">11.433333</td>
</tr>
<tr>
<td align="left">90</td>
<td align="left">TSTM WIND/HAIL</td>
<td align="right">26</td>
<td align="right">95</td>
<td align="right">3.653846</td>
</tr>
<tr>
<td align="left">95</td>
<td align="left">URBAN/SML STREAM FLD</td>
<td align="right">26</td>
<td align="right">79</td>
<td align="right">3.038461</td>
</tr>
<tr>
<td align="left">100</td>
<td align="left">WIND</td>
<td align="right">26</td>
<td align="right">84</td>
<td align="right">3.230769</td>
</tr>
<tr>
<td align="left">86</td>
<td align="left">TROPICAL STORM</td>
<td align="right">23</td>
<td align="right">338</td>
<td align="right">14.695652</td>
</tr>
<tr>
<td align="left">11</td>
<td align="left">DENSE FOG</td>
<td align="right">20</td>
<td align="right">143</td>
<td align="right">7.150000</td>
</tr>
</tbody>
</table>
<p><em>Weather events economic impact across Unites States</em></p>
<p>We'll examine the property and crop damages columns (PROPDMG * 10^PROPDMGEXP and CROPDMG * 10^CROPDMGEXP, respectively) from the dataset.</p>
<p>We need to preprocess the data to convert PROPDMG and PROPDMGEXP into numbers, idem for CROPDMG and CROPDMGEXP.</p>
<p>Values for the CROPDMGEXP and PROPDMEXP are:</p>
<ul>
<li>0 or blank</li>
<li>H for Hundred</li>
<li>K for Thousand</li>
<li>M for Million</li>
<li>B for Billion</li>
</ul>
<p>Note: Except for these exponential values (H,K,M,B), there is some inexpected values : ? + - and numbers in the initial dataset. This values doesn't appear in the dataset filtered by BGN_DATE &gt; 1996-01-01.</p>
<p>Let's check the repartition of the exponential categories:</p>
<div class="highlight"><pre><span class="code-line"><span class="kp">table</span><span class="p">(</span>data<span class="o">$</span>CROPDMGEXP<span class="p">)</span></span>
</pre></div>


<div class="highlight"><pre><span class="code-line">## </span>
<span class="code-line">##             B      K      M </span>
<span class="code-line">## 373047      4 278685   1771</span>
</pre></div>


<div class="highlight"><pre><span class="code-line"><span class="kp">table</span><span class="p">(</span>data<span class="o">$</span>PROPDMGEXP<span class="p">)</span></span>
</pre></div>


<div class="highlight"><pre><span class="code-line">## </span>
<span class="code-line">##             0      B      K      M </span>
<span class="code-line">## 276166      1     32 369934   7374</span>
</pre></div>


<p>We convert PROPDMG/PROPDMGEXP and CROPDMG/CROPDMGEXP pairs into numbers:</p>
<div class="highlight"><pre><span class="code-line">data<span class="o">$</span>cropdmg.exp <span class="o">&lt;-</span> <span class="m">1</span></span>
<span class="code-line">data<span class="p">[</span>data<span class="o">$</span>CROPDMGEXP <span class="o">==</span> <span class="s">&quot;H&quot;</span><span class="p">,</span> <span class="s">&quot;cropdmg.exp&quot;</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">100</span></span>
<span class="code-line">data<span class="p">[</span>data<span class="o">$</span>CROPDMGEXP <span class="o">==</span> <span class="s">&quot;K&quot;</span><span class="p">,</span> <span class="s">&quot;cropdmg.exp&quot;</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">1000</span></span>
<span class="code-line">data<span class="p">[</span>data<span class="o">$</span>CROPDMGEXP <span class="o">==</span> <span class="s">&quot;M&quot;</span><span class="p">,</span> <span class="s">&quot;cropdmg.exp&quot;</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">10</span><span class="o">^</span><span class="m">6</span></span>
<span class="code-line">data<span class="p">[</span>data<span class="o">$</span>CROPDMGEXP <span class="o">==</span> <span class="s">&quot;B&quot;</span><span class="p">,</span> <span class="s">&quot;cropdmg.exp&quot;</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">10</span><span class="o">^</span><span class="m">9</span></span>
<span class="code-line">data<span class="o">$</span>cropdmg.val <span class="o">&lt;-</span> data<span class="o">$</span>CROPDMG <span class="o">*</span> data<span class="o">$</span>cropdmg.exp</span>
<span class="code-line"></span>
<span class="code-line">data<span class="o">$</span>propdmg.exp <span class="o">&lt;-</span> <span class="m">1</span></span>
<span class="code-line">data<span class="p">[</span>data<span class="o">$</span>PROPDMGEXP <span class="o">==</span> <span class="s">&quot;H&quot;</span><span class="p">,</span> <span class="s">&quot;propdmg.exp&quot;</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">100</span></span>
<span class="code-line">data<span class="p">[</span>data<span class="o">$</span>PROPDMGEXP <span class="o">==</span> <span class="s">&quot;K&quot;</span><span class="p">,</span> <span class="s">&quot;propdmg.exp&quot;</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">1000</span></span>
<span class="code-line">data<span class="p">[</span>data<span class="o">$</span>PROPDMGEXP <span class="o">==</span> <span class="s">&quot;M&quot;</span><span class="p">,</span> <span class="s">&quot;propdmg.exp&quot;</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">1e+06</span></span>
<span class="code-line">data<span class="p">[</span>data<span class="o">$</span>PROPDMGEXP <span class="o">==</span> <span class="s">&quot;B&quot;</span><span class="p">,</span> <span class="s">&quot;propdmg.exp&quot;</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">1e+09</span></span>
<span class="code-line">data<span class="o">$</span>propdmg.val <span class="o">&lt;-</span> data<span class="o">$</span>PROPDMG <span class="o">*</span> data<span class="o">$</span>propdmg.exp</span>
</pre></div>


<p>We perform the same analysis as for weather type impact on population health:</p>
<div class="highlight"><pre><span class="code-line">crop_by_ev <span class="o">&lt;-</span> aggregate<span class="p">(</span>cropdmg.val <span class="o">~</span> EVTYPE<span class="p">,</span> data <span class="o">=</span> data<span class="p">,</span> <span class="kp">sum</span><span class="p">,</span> na.rm <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span></span>
<span class="code-line">quantile<span class="p">(</span>crop_by_ev<span class="o">$</span>cropdmg.val<span class="p">,</span> probs <span class="o">=</span> <span class="kp">seq</span><span class="p">(</span><span class="m">0.9</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.01</span><span class="p">))</span></span>
</pre></div>


<div class="highlight"><pre><span class="code-line">##         90%         91%         92%         93%         94%         95%         96%         97% </span>
<span class="code-line">##       80000      522000     1830000     8518338    15105600    22067850    51986350   225801006 </span>
<span class="code-line">##         98%         99%        100% </span>
<span class="code-line">##   611260434  1328471682 13367566000</span>
</pre></div>


<div class="highlight"><pre><span class="code-line">prop_by_ev <span class="o">&lt;-</span> aggregate<span class="p">(</span>propdmg.val <span class="o">~</span> EVTYPE<span class="p">,</span> data <span class="o">=</span> data<span class="p">,</span> <span class="kp">sum</span><span class="p">,</span> na.rm <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span></span>
<span class="code-line">quantile<span class="p">(</span>prop_by_ev<span class="o">$</span>propdmg.val<span class="p">,</span> probs <span class="o">=</span> <span class="kp">seq</span><span class="p">(</span><span class="m">0.9</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.01</span><span class="p">))</span></span>
</pre></div>


<div class="highlight"><pre><span class="code-line">##          90%          91%          92%          93%          94%          95%          96% </span>
<span class="code-line">##      6087080      7928162      9823200     19765792     40787880    117527100    551709366 </span>
<span class="code-line">##          97%          98%          99%         100% </span>
<span class="code-line">##   1328347705   4595502763  14205618003 143944833550</span>
</pre></div>


<div class="highlight"><pre><span class="code-line">crop_temp <span class="o">&lt;-</span> crop_by_ev<span class="p">[</span><span class="kp">order</span><span class="p">(</span>crop_by_ev<span class="o">$</span>cropdmg.val<span class="p">,</span> decreasing <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span> <span class="p">][</span><span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">,</span> <span class="p">]</span></span>
<span class="code-line"><span class="kp">colnames</span><span class="p">(</span>crop_temp<span class="p">)</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;event.type&quot;</span><span class="p">,</span> <span class="s">&quot;cropdmg.val&quot;</span><span class="p">)</span></span>
<span class="code-line">prop_temp <span class="o">&lt;-</span> prop_by_ev<span class="p">[</span><span class="kp">order</span><span class="p">(</span>prop_by_ev<span class="o">$</span>propdmg.val<span class="p">,</span> decreasing <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span> <span class="p">][</span><span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">,</span> <span class="p">]</span></span>
<span class="code-line"><span class="kp">colnames</span><span class="p">(</span>prop_temp<span class="p">)</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;event.type&quot;</span><span class="p">,</span> <span class="s">&quot;propdmg.val&quot;</span><span class="p">)</span></span>
<span class="code-line">kable<span class="p">(</span>crop_temp<span class="p">,</span> caption <span class="o">=</span> <span class="s">&quot;Total crop damages in (US dollars) by weather event type&quot;</span><span class="p">)</span></span>
</pre></div>


<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">event.type</th>
<th align="right">cropdmg.val</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">59</td>
<td align="left">DROUGHT</td>
<td align="right">13367566000</td>
</tr>
<tr>
<td align="left">99</td>
<td align="left">FLOOD</td>
<td align="right">4974778400</td>
</tr>
<tr>
<td align="left">166</td>
<td align="left">HURRICANE</td>
<td align="right">2741410000</td>
</tr>
<tr>
<td align="left">167</td>
<td align="left">HURRICANE/TYPHOON</td>
<td align="right">2607872800</td>
</tr>
<tr>
<td align="left">139</td>
<td align="left">HAIL</td>
<td align="right">2476029450</td>
</tr>
<tr>
<td align="left">96</td>
<td align="left">FLASH FLOOD</td>
<td align="right">1334901700</td>
</tr>
<tr>
<td align="left">81</td>
<td align="left">EXTREME COLD</td>
<td align="right">1288973000</td>
</tr>
<tr>
<td align="left">108</td>
<td align="left">FROST/FREEZE</td>
<td align="right">1094086000</td>
</tr>
<tr>
<td align="left">145</td>
<td align="left">HEAVY RAIN</td>
<td align="right">728169800</td>
</tr>
<tr>
<td align="left">420</td>
<td align="left">TROPICAL STORM</td>
<td align="right">677711000</td>
</tr>
<tr>
<td align="left">161</td>
<td align="left">HIGH WIND</td>
<td align="right">633561300</td>
</tr>
<tr>
<td align="left">423</td>
<td align="left">TSTM WIND</td>
<td align="right">553915350</td>
</tr>
<tr>
<td align="left">75</td>
<td align="left">EXCESSIVE HEAT</td>
<td align="right">492402000</td>
</tr>
<tr>
<td align="left">413</td>
<td align="left">THUNDERSTORM WIND</td>
<td align="right">398331000</td>
</tr>
<tr>
<td align="left">487</td>
<td align="left">WILDFIRE</td>
<td align="right">295472800</td>
</tr>
<tr>
<td align="left">417</td>
<td align="left">TORNADO</td>
<td align="right">283425010</td>
</tr>
<tr>
<td align="left">102</td>
<td align="left">FREEZE</td>
<td align="right">146225000</td>
</tr>
<tr>
<td align="left">486</td>
<td align="left">WILD/FOREST FIRE</td>
<td align="right">106782330</td>
</tr>
<tr>
<td align="left">150</td>
<td align="left">HEAVY SNOW</td>
<td align="right">71122100</td>
</tr>
<tr>
<td align="left">330</td>
<td align="left">STRONG WIND</td>
<td align="right">64953500</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span class="code-line">kable<span class="p">(</span>prop_temp<span class="p">,</span> caption <span class="o">=</span> <span class="s">&quot;Total property damages (in US dollars) by weather event type&quot;</span><span class="p">)</span></span>
</pre></div>


<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">event.type</th>
<th align="right">propdmg.val</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">99</td>
<td align="left">FLOOD</td>
<td align="right">143944833550</td>
</tr>
<tr>
<td align="left">167</td>
<td align="left">HURRICANE/TYPHOON</td>
<td align="right">69305840000</td>
</tr>
<tr>
<td align="left">327</td>
<td align="left">STORM SURGE</td>
<td align="right">43193536000</td>
</tr>
<tr>
<td align="left">417</td>
<td align="left">TORNADO</td>
<td align="right">24616905710</td>
</tr>
<tr>
<td align="left">96</td>
<td align="left">FLASH FLOOD</td>
<td align="right">15222203910</td>
</tr>
<tr>
<td align="left">139</td>
<td align="left">HAIL</td>
<td align="right">14595143420</td>
</tr>
<tr>
<td align="left">166</td>
<td align="left">HURRICANE</td>
<td align="right">11812819010</td>
</tr>
<tr>
<td align="left">420</td>
<td align="left">TROPICAL STORM</td>
<td align="right">7642475550</td>
</tr>
<tr>
<td align="left">161</td>
<td align="left">HIGH WIND</td>
<td align="right">5247860360</td>
</tr>
<tr>
<td align="left">487</td>
<td align="left">WILDFIRE</td>
<td align="right">4758667000</td>
</tr>
<tr>
<td align="left">328</td>
<td align="left">STORM SURGE/TIDE</td>
<td align="right">4641188000</td>
</tr>
<tr>
<td align="left">423</td>
<td align="left">TSTM WIND</td>
<td align="right">4478026440</td>
</tr>
<tr>
<td align="left">191</td>
<td align="left">ICE STORM</td>
<td align="right">3642248810</td>
</tr>
<tr>
<td align="left">413</td>
<td align="left">THUNDERSTORM WIND</td>
<td align="right">3382654440</td>
</tr>
<tr>
<td align="left">486</td>
<td align="left">WILD/FOREST FIRE</td>
<td align="right">3001782500</td>
</tr>
<tr>
<td align="left">496</td>
<td align="left">WINTER STORM</td>
<td align="right">1532733250</td>
</tr>
<tr>
<td align="left">59</td>
<td align="left">DROUGHT</td>
<td align="right">1046101000</td>
</tr>
<tr>
<td align="left">213</td>
<td align="left">LIGHTNING</td>
<td align="right">743077080</td>
</tr>
<tr>
<td align="left">150</td>
<td align="left">HEAVY SNOW</td>
<td align="right">634417540</td>
</tr>
<tr>
<td align="left">437</td>
<td align="left">TYPHOON</td>
<td align="right">600230000</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span class="code-line">ggplot<span class="p">(</span>crop_temp<span class="p">,</span> aes<span class="p">(</span>reorder<span class="p">(</span><span class="kp">factor</span><span class="p">(</span>event.type<span class="p">),</span> <span class="o">-</span>cropdmg.val<span class="p">),</span> cropdmg.val<span class="p">))</span> <span class="o">+</span> geom_bar<span class="p">(</span>stat <span class="o">=</span> <span class="s">&quot;identity&quot;</span><span class="p">)</span> <span class="o">+</span> </span>
<span class="code-line">    labs<span class="p">(</span>x <span class="o">=</span> <span class="s">&quot;Weather event type&quot;</span><span class="p">,</span> y <span class="o">=</span> <span class="s">&quot;Crop damages in US dollars&quot;</span><span class="p">,</span> title <span class="o">=</span> <span class="s">&quot;Total Crop damages by weather event type&quot;</span><span class="p">)</span> <span class="o">+</span> </span>
<span class="code-line">    theme<span class="p">(</span>axis.text.x <span class="o">=</span> element_text<span class="p">(</span>angle <span class="o">=</span> <span class="m">90</span><span class="p">,</span> hjust <span class="o">=</span> <span class="m">1</span><span class="p">))</span></span>
</pre></div>


<div class="rimage center"><img src="figure/weather_events_impact_crop_damages-1.png" title="plot of chunk weather_events_impact_crop_damages" alt="plot of chunk weather_events_impact_crop_damages" class="plot" /></div>

<div class="highlight"><pre><span class="code-line">ggplot<span class="p">(</span>prop_temp<span class="p">,</span> aes<span class="p">(</span>reorder<span class="p">(</span><span class="kp">factor</span><span class="p">(</span>event.type<span class="p">),</span> <span class="o">-</span>propdmg.val<span class="p">),</span> propdmg.val<span class="p">))</span> <span class="o">+</span> geom_bar<span class="p">(</span>stat <span class="o">=</span> <span class="s">&quot;identity&quot;</span><span class="p">)</span> <span class="o">+</span> </span>
<span class="code-line">    labs<span class="p">(</span>x <span class="o">=</span> <span class="s">&quot;Weather event type type&quot;</span><span class="p">,</span> y <span class="o">=</span> <span class="s">&quot;Properties damages in US dollars&quot;</span><span class="p">,</span> title <span class="o">=</span> <span class="s">&quot;Total Properties damages by weather event type&quot;</span><span class="p">)</span> <span class="o">+</span> </span>
<span class="code-line">    theme<span class="p">(</span>axis.text.x <span class="o">=</span> element_text<span class="p">(</span>angle <span class="o">=</span> <span class="m">90</span><span class="p">,</span> hjust <span class="o">=</span> <span class="m">1</span><span class="p">))</span></span>
</pre></div>


<div class="rimage center"><img src="figure/weather_events_impact_properties_damages-1.png" title="plot of chunk weather_events_impact_properties_damages" alt="plot of chunk weather_events_impact_properties_damages" class="plot" /></div>

<p>and we check damages ratio by event type:</p>
<div class="highlight"><pre><span class="code-line">crop_ev_count <span class="o">&lt;-</span> count<span class="p">(</span>data<span class="p">[</span>data<span class="o">$</span>cropdmg.val <span class="o">&gt;</span> <span class="m">0</span><span class="p">,</span> <span class="p">],</span> vars <span class="o">=</span> <span class="s">&quot;EVTYPE&quot;</span><span class="p">)</span></span>
<span class="code-line">temp <span class="o">&lt;-</span> <span class="kp">merge</span><span class="p">(</span>crop_ev_count<span class="p">,</span> crop_by_ev<span class="p">,</span> by <span class="o">=</span> <span class="s">&quot;EVTYPE&quot;</span><span class="p">)</span></span>
<span class="code-line">temp<span class="o">$</span>ratio <span class="o">&lt;-</span> temp<span class="o">$</span>cropdmg.val<span class="o">/</span>temp<span class="o">$</span>freq</span>
<span class="code-line"><span class="kp">colnames</span><span class="p">(</span>temp<span class="p">)</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;event.type&quot;</span><span class="p">,</span> <span class="s">&quot;event.frequency&quot;</span><span class="p">,</span> <span class="s">&quot;event.cropdamages&quot;</span><span class="p">,</span> <span class="s">&quot;event.cropdamages.ratio&quot;</span><span class="p">)</span></span>
<span class="code-line">kable<span class="p">(</span>temp<span class="p">[</span><span class="kp">order</span><span class="p">(</span>temp<span class="o">$</span>event.frequency<span class="p">,</span> decreasing <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span> <span class="p">][</span><span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">,</span> <span class="p">],</span> caption <span class="o">=</span> <span class="s">&quot;Total crop domages (in US dollars) by weather event type (ordered by frequency desc) since 1996&quot;</span><span class="p">)</span></span>
</pre></div>


<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">event.type</th>
<th align="right">event.frequency</th>
<th align="right">event.cropdamages</th>
<th align="right">event.cropdamages.ratio</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">22</td>
<td align="left">HAIL</td>
<td align="right">8100</td>
<td align="right">2476029450</td>
<td align="right">305682.65</td>
</tr>
<tr>
<td align="left">46</td>
<td align="left">TSTM WIND</td>
<td align="right">3440</td>
<td align="right">553915350</td>
<td align="right">161021.90</td>
</tr>
<tr>
<td align="left">14</td>
<td align="left">FLASH FLOOD</td>
<td align="right">1845</td>
<td align="right">1334901700</td>
<td align="right">723523.96</td>
</tr>
<tr>
<td align="left">15</td>
<td align="left">FLOOD</td>
<td align="right">1599</td>
<td align="right">4974778400</td>
<td align="right">3111180.99</td>
</tr>
<tr>
<td align="left">44</td>
<td align="left">TORNADO</td>
<td align="right">1254</td>
<td align="right">283425010</td>
<td align="right">226016.75</td>
</tr>
<tr>
<td align="left">43</td>
<td align="left">THUNDERSTORM WIND</td>
<td align="right">924</td>
<td align="right">398331000</td>
<td align="right">431094.16</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">DROUGHT</td>
<td align="right">243</td>
<td align="right">13367566000</td>
<td align="right">55010559.67</td>
</tr>
<tr>
<td align="left">27</td>
<td align="left">HIGH WIND</td>
<td align="right">200</td>
<td align="right">633561300</td>
<td align="right">3167806.50</td>
</tr>
<tr>
<td align="left">25</td>
<td align="left">HEAVY RAIN</td>
<td align="right">123</td>
<td align="right">728169800</td>
<td align="right">5920079.67</td>
</tr>
<tr>
<td align="left">53</td>
<td align="left">URBAN/SML STREAM FLD</td>
<td align="right">112</td>
<td align="right">8488100</td>
<td align="right">75786.61</td>
</tr>
<tr>
<td align="left">17</td>
<td align="left">FROST/FREEZE</td>
<td align="right">102</td>
<td align="right">1094086000</td>
<td align="right">10726333.33</td>
</tr>
<tr>
<td align="left">42</td>
<td align="left">STRONG WIND</td>
<td align="right">94</td>
<td align="right">64953500</td>
<td align="right">690994.68</td>
</tr>
<tr>
<td align="left">47</td>
<td align="left">TSTM WIND/HAIL</td>
<td align="right">89</td>
<td align="right">64696250</td>
<td align="right">726924.16</td>
</tr>
<tr>
<td align="left">56</td>
<td align="left">WILDFIRE</td>
<td align="right">89</td>
<td align="right">295472800</td>
<td align="right">3319919.10</td>
</tr>
<tr>
<td align="left">33</td>
<td align="left">LIGHTNING</td>
<td align="right">74</td>
<td align="right">6898440</td>
<td align="right">93222.16</td>
</tr>
<tr>
<td align="left">45</td>
<td align="left">TROPICAL STORM</td>
<td align="right">59</td>
<td align="right">677711000</td>
<td align="right">11486627.12</td>
</tr>
<tr>
<td align="left">28</td>
<td align="left">HURRICANE</td>
<td align="right">47</td>
<td align="right">2741410000</td>
<td align="right">58327872.34</td>
</tr>
<tr>
<td align="left">9</td>
<td align="left">EXTREME COLD</td>
<td align="right">46</td>
<td align="right">1288973000</td>
<td align="right">28021152.17</td>
</tr>
<tr>
<td align="left">55</td>
<td align="left">WILD/FOREST FIRE</td>
<td align="right">35</td>
<td align="right">106782330</td>
<td align="right">3050923.71</td>
</tr>
<tr>
<td align="left">29</td>
<td align="left">HURRICANE/TYPHOON</td>
<td align="right">33</td>
<td align="right">2607872800</td>
<td align="right">79026448.48</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span class="code-line">prop_ev_count <span class="o">&lt;-</span> count<span class="p">(</span>data<span class="p">[</span>data<span class="o">$</span>propdmg.val <span class="o">&gt;</span> <span class="m">0</span><span class="p">,</span> <span class="p">],</span> vars <span class="o">=</span> <span class="s">&quot;EVTYPE&quot;</span><span class="p">)</span></span>
<span class="code-line">temp <span class="o">&lt;-</span> <span class="kp">merge</span><span class="p">(</span>prop_ev_count<span class="p">,</span> prop_by_ev<span class="p">,</span> by <span class="o">=</span> <span class="s">&quot;EVTYPE&quot;</span><span class="p">)</span></span>
<span class="code-line">temp<span class="o">$</span>ratio <span class="o">&lt;-</span> temp<span class="o">$</span>propdmg.val<span class="o">/</span>temp<span class="o">$</span>freq</span>
<span class="code-line"><span class="kp">colnames</span><span class="p">(</span>temp<span class="p">)</span> <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;event.type&quot;</span><span class="p">,</span> <span class="s">&quot;event.frequency&quot;</span><span class="p">,</span> <span class="s">&quot;event.propdamages&quot;</span><span class="p">,</span> <span class="s">&quot;event.propdamages.ratio&quot;</span><span class="p">)</span></span>
<span class="code-line">kable<span class="p">(</span>temp<span class="p">[</span><span class="kp">order</span><span class="p">(</span>temp<span class="o">$</span>event.frequency<span class="p">,</span> decreasing <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span> <span class="p">][</span><span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">,</span> <span class="p">],</span> caption <span class="o">=</span> <span class="s">&quot;Total property damages (in US dollars) by weather event type (ordered by frequency desc) since 1996&quot;</span><span class="p">)</span></span>
</pre></div>


<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">event.type</th>
<th align="right">event.frequency</th>
<th align="right">event.propdamages</th>
<th align="right">event.propdamages.ratio</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">142</td>
<td align="left">TSTM WIND</td>
<td align="right">60331</td>
<td align="right">4478026440</td>
<td align="right">74224.30</td>
</tr>
<tr>
<td align="left">137</td>
<td align="left">THUNDERSTORM WIND</td>
<td align="right">42726</td>
<td align="right">3382654440</td>
<td align="right">79170.87</td>
</tr>
<tr>
<td align="left">65</td>
<td align="left">HAIL</td>
<td align="right">20002</td>
<td align="right">14595143420</td>
<td align="right">729684.20</td>
</tr>
<tr>
<td align="left">39</td>
<td align="left">FLASH FLOOD</td>
<td align="right">18647</td>
<td align="right">15222203910</td>
<td align="right">816335.28</td>
</tr>
<tr>
<td align="left">139</td>
<td align="left">TORNADO</td>
<td align="right">11847</td>
<td align="right">24616905710</td>
<td align="right">2077902.06</td>
</tr>
<tr>
<td align="left">41</td>
<td align="left">FLOOD</td>
<td align="right">9086</td>
<td align="right">143944833550</td>
<td align="right">15842486.63</td>
</tr>
<tr>
<td align="left">96</td>
<td align="left">LIGHTNING</td>
<td align="right">8744</td>
<td align="right">743077080</td>
<td align="right">84981.37</td>
</tr>
<tr>
<td align="left">74</td>
<td align="left">HIGH WIND</td>
<td align="right">5217</td>
<td align="right">5247860360</td>
<td align="right">1005915.35</td>
</tr>
<tr>
<td align="left">131</td>
<td align="left">STRONG WIND</td>
<td align="right">3206</td>
<td align="right">174741450</td>
<td align="right">54504.51</td>
</tr>
<tr>
<td align="left">166</td>
<td align="left">WINTER STORM</td>
<td align="right">1344</td>
<td align="right">1532733250</td>
<td align="right">1140426.53</td>
</tr>
<tr>
<td align="left">68</td>
<td align="left">HEAVY SNOW</td>
<td align="right">943</td>
<td align="right">634417540</td>
<td align="right">672765.15</td>
</tr>
<tr>
<td align="left">67</td>
<td align="left">HEAVY RAIN</td>
<td align="right">906</td>
<td align="right">584864440</td>
<td align="right">645545.74</td>
</tr>
<tr>
<td align="left">163</td>
<td align="left">WILDFIRE</td>
<td align="right">723</td>
<td align="right">4758667000</td>
<td align="right">6581835.41</td>
</tr>
<tr>
<td align="left">157</td>
<td align="left">URBAN/SML STREAM FLD</td>
<td align="right">670</td>
<td align="right">58309650</td>
<td align="right">87029.33</td>
</tr>
<tr>
<td align="left">84</td>
<td align="left">ICE STORM</td>
<td align="right">594</td>
<td align="right">3642248810</td>
<td align="right">6131732.00</td>
</tr>
<tr>
<td align="left">141</td>
<td align="left">TROPICAL STORM</td>
<td align="right">390</td>
<td align="right">7642475550</td>
<td align="right">19596091.15</td>
</tr>
<tr>
<td align="left">152</td>
<td align="left">TSTM WIND/HAIL</td>
<td align="right">380</td>
<td align="right">44320500</td>
<td align="right">116632.89</td>
</tr>
<tr>
<td align="left">167</td>
<td align="left">WINTER WEATHER</td>
<td align="right">373</td>
<td align="right">20866000</td>
<td align="right">55941.02</td>
</tr>
<tr>
<td align="left">162</td>
<td align="left">WILD/FOREST FIRE</td>
<td align="right">303</td>
<td align="right">3001782500</td>
<td align="right">9906872.94</td>
</tr>
<tr>
<td align="left">88</td>
<td align="left">LAKE-EFFECT SNOW</td>
<td align="right">194</td>
<td align="right">40115000</td>
<td align="right">206778.35</td>
</tr>
</tbody>
</table>
<h2 id="conclusions">Conclusions</h2>
<p><em>Wheater events impact on population health</em>
Our analysys shows that since 1996:</p>
<ul>
<li>The "Tornado" event caused the most injuries</li>
<li>Both the "Tornado" and "Excessive heat" events caused the most fatalities</li>
</ul>
<p>From the frequency/ratio table, we can notice that:</p>
<ul>
<li>The "Lightning", "Flash Flood" and "Excessive Heat" are the most frequent events regarding events causing fatalities</li>
<li>The "Lightning", "Tornado" and "TSM Wind" are the most frequent events regarding events causing injuries</li>
<li>The "Excessive heat", "Flood" and "Heat", have a very high ratio regarding injuries</li>
</ul>
<p><em>Wheater events impact on economy</em>
Our analysys shows that since 1996:</p>
<ul>
<li>The "Drought" event caused the most crop damages</li>
<li>The "Flood" events caused the most property damages</li>
</ul>
<p>From the frequency/ratio table, we can notice that:</p>
<ul>
<li>The "Hail" event is the most frequent event regarding events causing crop damages</li>
<li>The "TSTM Wind" event is the most frequent event regarding events causing property damages</li>
<li>The "Drought" and "Hurricane" events have a very high crop damages ratio</li>
<li>The "Flood" and "Tropical storm" events have a very high property damages ratio</li>
</ul>
            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Related Posts:</h4>
    <ul>
        <li><a href="http://stephanie-w.github.io/brainscribble/hypothesis-testing-and-t-tests.html">Notes on Statistical Inference : Hypothesis Testing and t-tests</a></li>
        <li><a href="http://stephanie-w.github.io/brainscribble/experimentation-of-clt.html">R: Experimentation of the Cental Limit Theorem</a></li>
        <li><a href="http://stephanie-w.github.io/brainscribble/exploring-data-for-marchine-learning.html">R : Exploring Data for Machine Learning Modeling</a></li>
        <li><a href="http://stephanie-w.github.io/brainscribble/multivariable-regression.html">R: Multivariable Regression</a></li>
        <li><a href="http://stephanie-w.github.io/brainscribble/last_earthquakes.html">R: Earthquakes from the past 30 days</a></li>
    </ul>
</section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
        <a href="http://stephanie-w.github.io/brainscribble/" class="home-url">
Brain Scribble    <li class="list-group-item">
        <ul class="list-group" id="links">
            <img class="img-thumbnail" src="http://stephanie-w.github.io/brainscribble/images/brain-scribble.png"/>
        </ul>
    </li>
        </a>



            <li class="list-group-item"><a href="http://stephanie-w.github.io/brainscribble/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                <ul class="list-group " id="tags">
                    <li class="list-group-item tag-1">
                        <a href="http://stephanie-w.github.io/brainscribble/tag/r.html">
                            R
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://stephanie-w.github.io/brainscribble/tag/stats.html">
                            stats
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://stephanie-w.github.io/brainscribble/tag/machine-learning.html">
                            machine-learning
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://stephanie-w.github.io/brainscribble/tag/ipython-notebook.html">
                            ipython-notebook
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://stephanie-w.github.io/brainscribble/tag/scikit-learn.html">
                            scikit-learn
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://stephanie-w.github.io/brainscribble/tag/hadoop.html">
                            hadoop
                        </a>
                    </li>
                </ul>
            </li>


            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://fr.linkedin.com/pub/stephanie-werli/26/b69/a0b"><i class="fa fa-linkedin-square fa-lg"></i> linkedin</a></li>
                <li class="list-group-item"><a href="http://github.com/stephanie-w"><i class="fa fa-github-square fa-lg"></i> github</a></li>
              </ul>
            </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container-fluid">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015 Stephanie W
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://stephanie-w.github.io/brainscribble/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://stephanie-w.github.io/brainscribble/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://stephanie-w.github.io/brainscribble/theme/js/respond.min.js"></script>


</body>
</html>